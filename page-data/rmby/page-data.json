{"componentChunkName":"component---src-templates-blog-post-js","path":"/rmby/","result":{"data":{"site":{"siteMetadata":{"title":"Duman Codes","author":"Yadullah Duman"}},"markdownRemark":{"id":"8616d784-6d8c-5019-bf66-b4aa90052044","excerpt":"Recently, I released version 1.0 of my first Node.js library called rmby. In this post, I want to explain what it is, what it does and how…","html":"<p>Recently, I released version 1.0 of my first Node.js library called <a href=\"https://www.npmjs.com/package/rmby\">rmby</a>. In this post, I want to explain what it is, what it does and how you can use it. On the bottom of this post you will find the respective links. Enjoy ❤️</p>\n<h2>What is rmby?</h2>\n<p>rmby (“remove by”) is a zero-dependency Node.js library for removing files asynchronously on a given directory by certain filter criteria’s. It provides a <a href=\"https://martinfowler.com/bliki/FluentInterface.html\">fluent interface</a> that guides the user when creating the remove query.</p>\n<h2>Why rmby?</h2>\n<p>In one of my side projects I had the use case where I needed to remove files on a directory that were older than X hours with a cronjob. Of course the first thing you do is look for libraries. I found one, but it only supported synchronous removal and I had to provide the time in minutes instead of hours.</p>\n<p>I mean it did the job, but somehow I felt like I could easily develop this natively by myself and it would also run asynchronously. So, I implemented a version that did the job asynchronously and I could also provide the amount of hours. Neat!</p>\n<p>Then, I had the idea that you could easily extend this behavior by more filter criteria’s. Why not remove it by minutes, or by seconds, or by names? Since I was always curious about library development in Node.js, I thought why not give it a shot and provide this functionality for everyone else?</p>\n<p>So I began coding…</p>\n<h2>Usage</h2>\n<p>In order to use rmby, install it with NPM or Yarn.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">npm</span> i --save rmby\n$ <span class=\"token function\">yarn</span> <span class=\"token function\">add</span> rmby</code></pre></div>\n<p>And then import it in your Node.js project.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// JS</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> RemoveFiles <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'rmby'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// TS</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> RemoveFiles <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'rmby'</span></code></pre></div>\n<p>In the section below you can see on how to form your remove queries.</p>\n<h2>The API</h2>\n<p>rmby follows the pattern of a fluent interface. With this technique you kind of define a grammar for your API. Every chain in the method has a rule on what to call next. This prevents incorrect usage of the API and guides the user through the method chain with code-completion tools like IntelliSense. In order to execute the removal, you need to call the <code class=\"language-text\">run(): Promise&lt;string[]&gt;</code> method on the end of your chain, which will return the file paths that were removed upon termination.</p>\n<h3>Remove By Time</h3>\n<p>Files can be removed by a time difference in milliseconds, seconds, minutes or hours. The time difference is always checked against the current time.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">new</span> <span class=\"token class-name\">RemoveFiles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/some/dir'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">byTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">inMilliseconds</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">olderThan</span><span class=\"token punctuation\">(</span><span class=\"token number\">1200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">new</span> <span class=\"token class-name\">RemoveFiles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/some/dir'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">byTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">inSeconds</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">olderThan</span><span class=\"token punctuation\">(</span><span class=\"token number\">90</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">new</span> <span class=\"token class-name\">RemoveFiles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/some/dir'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">byTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">inMinutes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">olderThan</span><span class=\"token punctuation\">(</span><span class=\"token number\">150</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">new</span> <span class=\"token class-name\">RemoveFiles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/some/dir'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">byTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">inHours</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">olderThan</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>Remove By Name</h3>\n<p>Files can be removed regarding its name without considering the file extension. You can remove files that match exactly, start with, end with, or include the name that you provide.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">new</span> <span class=\"token class-name\">RemoveFiles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/some/dir'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">byName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">thatEqualsTo</span><span class=\"token punctuation\">(</span><span class=\"token string\">'index'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">new</span> <span class=\"token class-name\">RemoveFiles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/some/dir'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">byName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">thatStartsWith</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ind'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">new</span> <span class=\"token class-name\">RemoveFiles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/some/dir'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">byName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">thatEndsWith</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dex'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">new</span> <span class=\"token class-name\">RemoveFiles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/some/dir'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">byName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">thatIncludes</span><span class=\"token punctuation\">(</span><span class=\"token string\">'nde'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>Remove By Extension</h3>\n<p>Files can be removed regarding their file extension. You can remove files that match exactly with the extension you provide.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">new</span> <span class=\"token class-name\">RemoveFiles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/some/dir'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">byExtension</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.log'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>Remove By Combination</h3>\n<p>Files can be removed by combining the available filters. Therefore you can create more specific filters for your use case.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">new</span> <span class=\"token class-name\">RemoveFiles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/some/dir'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">byName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">thatStartsWith</span><span class=\"token punctuation\">(</span><span class=\"token string\">'app'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">and</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">byExtension</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.log'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">and</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">byTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">inHours</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">olderThan</span><span class=\"token punctuation\">(</span><span class=\"token number\">24</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>The Future</h2>\n<p>I already plan to support more filters and also another class that removes recursively in deep nested directories, since the library currently only focuses on the context of the given directory.</p>\n<h3>Links</h3>\n<p>GitHub: <a href=\"https://github.com/yduman/rmby\">https://github.com/yduman/rmby</a> <br>\nNPM: <a href=\"https://www.npmjs.com/package/rmby\">https://www.npmjs.com/package/rmby</a></p>","timeToRead":3,"frontmatter":{"title":"rmby - A Node.js library for removing files asynchronously with a fluent interface","date":"August 17, 2020","spoiler":"File removal was never easier before!"},"fields":{"slug":"/rmby/"}}},"pageContext":{"slug":"/rmby/","previous":{"fields":{"slug":"/wsl2-setup/"},"frontmatter":{"title":"How to setup WSL2 with Windows Terminal, oh-my-zsh and powerlevel10k"}},"next":null}},"staticQueryHashes":["336482444"]}